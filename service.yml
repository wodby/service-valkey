name: valkey
icon: valkey
type: datastore
title: Valkey
hostname: valkey
containers:
- name: valkey
  image: wodby/valkey
options:
- version: '8.1'
  tag: '8.1'
- version: '7.2'
  tag: '7.2'
endpoints:
- name: valkey
  ports:
  - name: valkey
    number: 6379
    type: tcp
labels:
- valkey

volumes:
- name: data
  title: Data
  optional: true
  helm: 
# @todo: remove labels if imports added
    labels: persistence.labels  
    values:
    - name: persistence.enabled
      value: true
    - name: persistence.size
      value: '{{volumes.data.size}}Gi'
    # mandatory to use existing claim since this volume will have import function
    # we will mount different claim after import and doing it through sts's volumeclaimtemplates is not supported
# disabled due to missing imports (required for this to work â€“ we create PVC manually instead of using volumeClaimTemplate)
# @todo: remove labels if imports added
#    - name: persistence.existingClaim
#      value: '{{volumes.data.claim}}'

tokens:
- name: password
  generate:
    regex: '[0-9a-z-]{32}'

helm:
  name: wodby
  source: oci://registry-1.docker.io/wodby/valkey
  chart: oci://registry-1.docker.io/wodby/valkey
  version: 0.1.0
  configurations:
  - name: valkey    
    labels: podLabels
    annotations: podAnnotations
    env: envVars
    resources: resources
  values:
  - name: auth.password
    value: '{{password}}'
